{"ts":1342449908990,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"$(document).ready(function(e) {\r\n\t$(\".selection\").click(function(e) {\r\n\t\t$(\".selection\").removeClass(\"selected\");\r\n\t\t$(this).addClass(\"selected\");\r\n        var left;\r\n\t\tleft = $(this).position().left + (($(this).width() - 140)/2 + 10);\r\n\t\t$(\"#selectorImg\").animate({\"left\":left},\"fast\");\r\n\t\t$(\"#selectedText\").html($(this).html());\r\n\t\t_selPos = $(this);\r\n\t\tsortGraphics();\r\n    });\r\n    $(\"#selectorImg\").draggable({\r\n\t\taxis : \"x\",\r\n\t\tcontainment : \"#selector\",\r\n\t\tdrag : function(){\r\n\t\t\tif(checkSelection() === \"LC\"){\r\n\t\t\t\t$(\"#selectedText\").html(\"LEAST<br>CONCERN\");\r\n\t\t\t}\r\n\t\t\telse if(checkSelection() === \"NT\"){\r\n\t\t\t\t$(\"#selectedText\").html(\"NEAR<br>THREATENED\");\r\n\t\t\t}\r\n\t\t\telse if(checkSelection() === \"VU\"){\r\n\t\t\t\t$(\"#selectedText\").html(\"VULNERABLE\");\r\n\t\t\t}\r\n\t\t\telse if(checkSelection() === \"EN\"){\r\n\t\t\t\t$(\"#selectedText\").html(\"ENDANGERED\");\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t$(\"#selectedText\").html(\"CRITICALLY ENDANGERED\");\r\n\t\t\t}\r\n\t\t},\r\n\t\tstop : function(){\r\n\t\t\tvar left;\r\n\t\t\t$(\".selection\").removeClass(\"selected\");\r\n\t\t\tif(checkSelection() == \"LC\"){\r\n\t\t\t\t$(\"#lcFull\").addClass(\"selected\");\r\n\t\t\t\tleft = $(\"#lcFull\").position().left + (($(\"#lcFull\").width() - 140)/2 + 10);\r\n\t\t\t\t$(\"#selectorImg\").animate({\"left\":left},100);\r\n\t\t\t\t_selPos = $(\"#lcFull\");\r\n\t\t\t}\r\n\t\t\telse if(checkSelection() == \"NT\"){\r\n\t\t\t\t$(\"#ntFull\").addClass(\"selected\");\r\n\t\t\t\tleft = $(\"#ntFull\").position().left + (($(\"#ntFull\").width() - 140)/2 + 10);\r\n\t\t\t\t$(\"#selectorImg\").animate({\"left\":left},100);\r\n\t\t\t\t_selPos = $(\"#ntFull\");\r\n\t\t\t}\r\n\t\t\telse if(checkSelection() == \"VU\"){\r\n\t\t\t\t$(\"#vuFull\").addClass(\"selected\");\r\n\t\t\t\tleft = $(\"#vuFull\").position().left + (($(\"#vuFull\").width() - 140)/2 + 10);\r\n\t\t\t\t$(\"#selectorImg\").animate({\"left\":left},100);\r\n\t\t\t\t_selPos = $(\"#vuFull\");\r\n\t\t\t}\r\n\t\t\telse if(checkSelection() == \"EN\"){\r\n\t\t\t\t$(\"#enFull\").addClass(\"selected\");\r\n\t\t\t\tleft = $(\"#enFull\").position().left + (($(\"#enFull\").width() - 140)/2) + 10;\r\n\t\t\t\t$(\"#selectorImg\").animate({\"left\":left},100);\r\n\t\t\t\t_selPos = $(\"#enFull\");\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t$(\"#crFull\").addClass(\"selected\");\r\n\t\t\t\tleft = $(\"#crFull\").position().left + (($(\"#crFull\").width() - 140)/2 + 10);\r\n\t\t\t\t$(\"#selectorImg\").animate({\"left\":left},100);\r\n\t\t\t\t_selPos = $(\"#crFull\");\r\n\t\t\t}\r\n\t\t\tsortGraphics();\r\n\t\t}\r\n\t});\r\n});\r\n\r\n$(window).resize(function(){\r\n    resetLayout();\r\n});\r\n\r\ndojo.ready(function(){\r\n    resetLayout();\r\n\t$(\"#selectorImg\").css(\"left\",$(\"#vuFull\").position().left + (($(\"#vuFull\").width() - 140)/2));\r\n});\r\n\r\nvar setUpBanner = function(){\r\n    $(\"#title\").html(configOptions.title);\r\n    $(\"#subtitle\").html(configOptions.subtitle);\r\n};\r\n\r\nvar resetLayout = function(){\r\n\t$(\"#selector\").css(\"width\",$(\"#selectorCon\").width() - 30);\r\n\t$(\"#selectorImg\").css(\"bottom\",25 - ($(\"#lcFull\").height()/2));\r\n\tif (_selPos !== undefined){\r\n\t\t$(\"#selectorImg\").css(\"left\",_selPos.position().left + ((_selPos.width() - 140)/2) + 10);\r\n\t}\r\n\telse {\r\n\t\t$(\"#selectorImg\").css(\"left\",$(\"#vuFull\").position().left + (($(\"#vuFull\").width() - 140)/2) + 10);\r\n\t}\r\n};\r\n\r\nvar checkSelection = function(){\r\n\tvar selectorLeft = $(\"#selectorImg\").position().left + 70;\r\n\tvar lc = $(\"#lcFull\").position().left+$(\"#lcFull\").width();\r\n\tvar nt = $(\"#ntFull\").position().left+$(\"#ntFull\").width();\r\n\tvar vu = $(\"#vuFull\").position().left+$(\"#vuFull\").width();\r\n\tvar en = $(\"#enFull\").position().left+$(\"#enFull\").width();\r\n\tif (selectorLeft <= lc){\r\n\t\treturn \"LC\";\r\n\t}\r\n\telse if (selectorLeft <= nt){\r\n\t\treturn \"NT\";\r\n\t}\r\n\telse if (selectorLeft <= vu){\r\n\t\treturn \"VU\";\r\n\t}\r\n\telse if (selectorLeft <= en){\r\n\t\treturn \"EN\";\r\n\t}\r\n\telse{\r\n\t\treturn\"CR\"\r\n\t}\r\n};"]],"start1":0,"start2":0,"length1":0,"length2":3569}]],"length":3569}
{"contributors":[],"silentsave":true,"ts":1345749304073,"patch":[[{"diffs":[[1,"if ((\"onhashchange\" in window) && !($.browser.msie)) {\r\n    window.onhashchange = function () {\r\n        if(window.location.hash === \"#overview\" && $(\"#modalBackground\").is(\":visible\")){\r\n            $(\"#modalBackground\").fadeOut(\"fast\");\r\n            $(\"#speciesPanel\").fadeOut(\"fast\");\r\n            setTimeout(function(){\r\n                $(\"#modalBackground\").remove();\r\n                $(\"#speciesPanel\").remove();\r\n            },200);\r\n        }\r\n        else if(_currentSelection !== window.location.hash && window.location.hash !== \"#overview\" && $(\"#modalBackground\").is(\":visible\")){\r\n            var order;\r\n            if ($(\"#imgLinkOdd\").length > 0){\r\n                order = \"Odd\";\r\n            }\r\n            else{\r\n                order = \"Even\";\r\n            }\r\n            dojo.forEach(_points.graphics,function(g){\r\n            \tif(\"#\"+g.attributes.TaxonID === window.location.hash){\r\n                    $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                    $(\"#commonName\"+order).fadeOut(\"fast\");\r\n                    $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                    $(\"#sciName\"+order).fadeOut(\"fast\");\r\n                    $(\"#statusText\"+order).fadeOut(\"fast\");\r\n                    $(\"#speciesDescription\"+order).fadeOut(\"fast\");\r\n                    $(\"#nextArrow\"+order).fadeOut(\"fast\");\r\n                    $(\"#prevArrow\"+order).fadeOut(\"fast\");\r\n                    $(\"#moreInfo\"+order).fadeOut(\"fast\");\r\n                    setTimeout(function() {\r\n                        $(\"#imgLink\"+order).remove();\r\n                        $(\"#commonName\"+order).remove();\r\n                        $(\"#imgLink\"+order).remove();\r\n                        $(\"#sciName\"+order).remove();\r\n                        $(\"#statusText\"+order).remove();\r\n                        $(\"#speciesDescription\"+order).remove();\r\n                        $(\"#nextArrow\"+order).remove();\r\n                        $(\"#prevArrow\"+order).remove();\r\n                        $(\"#moreInfo\"+order).remove();\r\n                    }, 200);\r\n                    _speciesMap.firstLoad = false;\r\n                    _outlineLayer.setDefinitionExpression(\"TaxonID='\"+g.attributes.TaxonID+\"'\");\r\n                    _fillLayer.setDefinitionExpression(\"TaxonID='\"+g.attributes.TaxonID+\"'\");\r\n        \t\t\topenPopout(g.attributes,false);\r\n        \t\t}\r\n        \t});\r\n        }\r\n        else {\r\n            if (window.location.hash !== _currentSelection && window.location.hash !== \"#overview\"){\r\n                window.history.back();\r\n            }\r\n        }\r\n    };\r\n}\r\nelse {\r\n    var prevHash = window.location.hash;\r\n    window.setInterval(function () {\r\n        if (window.location.hash !== prevHash) {\r\n            storedHash = window.location.hash;\r\n            if(window.location.hash === \"#overview\" && $(\"#modalBackground\").is(\":visible\")){\r\n            $(\"#modalBackground\").fadeOut(\"fast\");\r\n            $(\"#speciesPanel\").fadeOut(\"fast\");\r\n            setTimeout(function(){\r\n                $(\"#modalBackground\").remove();\r\n                $(\"#speciesPanel\").remove();\r\n            },200);\r\n        }\r\n        else if(_currentSelection !== window.location.hash && window.location.hash !== \"#overview\" && $(\"#modalBackground\").is(\":visible\")){\r\n            var order;\r\n            if ($(\"#imgLinkOdd\").length > 0){\r\n                order = \"Odd\";\r\n            }\r\n            else{\r\n                order = \"Even\";\r\n            }\r\n            dojo.forEach(_points.graphics,function(g){\r\n                if(\"#\"+g.attributes.TaxonID === window.location.hash){\r\n                    $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                    $(\"#commonName\"+order).fadeOut(\"fast\");\r\n                    $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                    $(\"#sciName\"+order).fadeOut(\"fast\");\r\n                    $(\"#statusText\"+order).fadeOut(\"fast\");\r\n                    $(\"#speciesDescription\"+order).fadeOut(\"fast\");\r\n                    $(\"#nextArrow\"+order).fadeOut(\"fast\");\r\n                    $(\"#prevArrow\"+order).fadeOut(\"fast\");\r\n                    $(\"#moreInfo\"+order).fadeOut(\"fast\");\r\n                    setTimeout(function() {\r\n                        $(\"#imgLink\"+order).remove();\r\n                        $(\"#commonName\"+order).remove();\r\n                        $(\"#imgLink\"+order).remove();\r\n                        $(\"#sciName\"+order).remove();\r\n                        $(\"#statusText\"+order).remove();\r\n                        $(\"#speciesDescription\"+order).remove();\r\n                        $(\"#nextArrow\"+order).remove();\r\n                        $(\"#prevArrow\"+order).remove();\r\n                        $(\"#moreInfo\"+order).remove();\r\n                    }, 200);\r\n                    _speciesMap.firstLoad = false;\r\n                    _outlineLayer.setDefinitionExpression(\"TaxonID='\"+g.attributes.TaxonID+\"'\");\r\n                    _fillLayer.setDefinitionExpression(\"TaxonID='\"+g.attributes.TaxonID+\"'\");\r\n        \t\t\topenPopout(g.attributes,false);\r\n        \t\t}\r\n        \t});\r\n        }\r\n        else {\r\n            if (window.location.hash !== _currentSelection){\r\n                window.history.back();\r\n            }\r\n        }\r\n        }\r\n    }, 100);\r\n}\r\n\r\n"],[0,"$(docume"]],"start1":0,"start2":0,"length1":8,"length2":5207},{"diffs":[[0,"ion(){\r\n"],[1,"            hidePopup();\r\n"],[0,"\t\t\tif(ch"]],"start1":5676,"start2":5676,"length1":16,"length2":42},{"diffs":[[0,"turn\"CR\""],[1,";"],[0,"\r\n\t}\r\n};"],[1,"\r\n\r\nvar hidePopup = function(){\r\n    $(\"#hoverInfo\").hide();\r\n    $(\"#hoverInfoPointer\").hide();\r\n    $(\".speciesItem\").removeClass(\"selectedItem\");\r\n    $(\".arrow\").hide();\r\n};\r\n\r\nvar getOppositeOrder = function(order){\r\n    if (order == \"Odd\"){\r\n        return \"Even\";\r\n    }\r\n    else{\r\n        return \"Odd\";\r\n    }\r\n};\r\n\r\nvar openPopout = function(attr,newPopout){\r\n    _currentSelection = \"#\"+attr.TaxonID;\r\n    if (iPad === false){\r\n        window.location.hash = attr.TaxonID;\r\n    }\r\n    if(newPopout === true){\r\n        $(\"body\").append(\"<div id='modalBackground'></div><div id='speciesPanel'></div>\");\r\n        $(\"#modalBackground\").fadeTo(\"slow\",\"0.7\");\r\n        $(\"#speciesPanel\").fadeIn().append(\"<div id='speciesMap' class='speciesContent'></div><div id='speciesContent' class='speciesContent'></div><div id='closeButton' class='ui-icons-close'>Close</div>\");\r\n        $(\".speciesContent\").css(\"height\",$(\"#speciesPanel\").height());\r\n        $(\"#speciesMap\").css(\"width\",$(\"#speciesPanel\").width() - getWidth()).append(\"<div id='zoomToggleMini' class='zoomToggle'><img id='zoomInMini' class='zoomIn' src='images/ZoomLight_01.png'><img id='zoomExtentMini' class='zoomExtent' src='images/ZoomLight_02.png'><img id='zoomOutMini' class='zoomOut' src='images/ZoomLight_03.png'></div>\");\r\n        if (iPad === true) {\r\n            $(\".zoomExtent\").css(\"margin-top\",\"-4px\");\r\n            $(\".zoomOut\").css(\"margin-top\",\"-4px\");\r\n        }\r\n        $(\"#zoomToggleMini\").css(\"margin-left\",getWidth() + 15).css(\"margin-top\",15).show();\r\n        $(\"#closeButton\").button({\r\n            icons : {\r\n                primary : \"ui-icon-closethick\"\r\n            },\r\n            text:false\r\n        }).click(function(){\r\n            $(\"#modalBackground\").fadeOut(\"fast\");\r\n            $(\"#speciesPanel\").fadeOut(\"fast\");\r\n            setTimeout(function(){\r\n                $(\"#modalBackground\").remove();\r\n                $(\"#speciesPanel\").html(\"\");\r\n                $(\"#speciesPanel\").remove();\r\n                if (iPad === false){\r\n                    window.location.hash = \"overview\";\r\n                }\r\n            },200);\r\n        });\r\n    }\r\n    var order;\r\n    if ($(\"#imgLinkOdd\").length > 0){\r\n        order = \"Even\";\r\n    }\r\n    else{\r\n        order = \"Odd\";\r\n    }\r\n    $(\"#speciesContent\").append(\"<a id='imgLink\"+order+\"' href='\"+attr.ArkiveURL+\"' target='_blank'><img id='speciesImg\"+order+\"' class='speciesImg' src='images/photos/\"+attr.Photo_URL+\"' alt=''></a>\").css(\"width\",getWidth());\r\n    $(\".speciesImg\").css(\"width\",getWidth());\r\n    $(\"#speciesImg\"+order).load(function(){\r\n        var delay;\r\n        if (newPopout === false){\r\n            delay = 200;\r\n        }\r\n        else{\r\n            delay = 0;\r\n        }\r\n        setTimeout(function() {\r\n            $(\"#speciesContent\").append(\"<div id='commonName\"+order+\"' class='commonName'>\"+attr.Common_name+\"</div>\");\r\n            $(\"#speciesContent\").append(\"<div id='sciName\"+order+\"' class='listingText sciName'><span class='lsText'>SCIENTIFIC NAME: </span><em>\"+attr.Latin_name+\"</em></div>\").append(\"<div id='statusText\"+order+\"' class='listingText statusText'><span class='lsText'>IURED LIST STATUS: </span>\"+attr.RLdescrpt+\"</div>\");\r\n            $(\"#speciesPanel\").append(\"<div id='speciesDescription\"+order+\"' class='speciesDescription'>\"+attr.Description+\"</div>\");\r\n            $(\".listingText\").css(\"width\",300 - (400 - getWidth()));\r\n            $(\"#speciesDescription\"+order).css(\"top\",$(\"#speciesImg\"+order).height() + $(\"#sciName\"+order).height() + $(\"#statusText\"+order).height() + 65).css(\"height\",$(\"#speciesContent\").height() - $(\"#speciesImg\"+order).height() - $(\"#sciName\"+order).height() - $(\"#statusText\"+order).height() - 80);\r\n            $(\"#speciesPanel\").append(\"<a id='moreInfo\"+order+\"' class='moreInfo' href='\"+attr.RedListURL+\"' target='_blank'><em>More Information &gt;</em></a><div id='nextArrow\"+order+\"' class='nextArrow'></div><div id='prevArrow\"+order+\"' class='prevArrow'></div>\");\r\n            $(\"#moreInfo\"+order).css(\"top\",$(\"#speciesContent\").height()).fadeIn(\"fast\");\r\n            $(\".speciesDescription\").css(\"width\",355 - (400 - getWidth()));\r\n            $(\".commonName\").css(\"width\",300 - (400 - getWidth()));\r\n            $(\"#speciesImg\"+order).fadeIn(\"fast\");\r\n            $(\"#commonName\"+order).fadeIn(\"fast\");\r\n            $(\"#sciName\"+order).fadeIn(\"fast\");\r\n            $(\"#statusText\"+order).fadeIn(\"fast\");\r\n            $(\"#speciesDescription\"+order).fadeIn(\"fast\");\r\n            $(\"#nextArrow\"+order).css(\"top\",$(\"#speciesImg\"+order).height() + $(\"#sciName\"+order).height() + 25).css(\"left\",$(\"#sciName\"+order).width() + 60).show().click(function(){\r\n                $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                $(\"#commonName\"+order).fadeOut(\"fast\");\r\n                $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                $(\"#sciName\"+order).fadeOut(\"fast\");\r\n                $(\"#statusText\"+order).fadeOut(\"fast\");\r\n                $(\"#speciesDescription\"+order).fadeOut(\"fast\");\r\n                $(\"#nextArrow\"+order).fadeOut(\"fast\");\r\n                $(\"#prevArrow\"+order).fadeOut(\"fast\");\r\n                $(\"#moreInfo\"+order).fadeOut(\"fast\");\r\n                setTimeout(function() {\r\n                    $(\"#imgLink\"+order).remove();\r\n                    $(\"#commonName\"+order).remove();\r\n                    $(\"#imgLink\"+order).remove();\r\n                    $(\"#sciName\"+order).remove();\r\n                    $(\"#statusText\"+order).remove();\r\n                    $(\"#speciesDescription\"+order).remove();\r\n                    $(\"#nextArrow\"+order).remove();\r\n                    $(\"#prevArrow\"+order).remove();\r\n                    $(\"#moreInfo\"+order).remove();\r\n                }, 200);\r\n                nextSpecies(attr);\r\n            });\r\n            $(\"#prevArrow\"+order).css(\"top\",$(\"#speciesImg\"+order).height() + $(\"#sciName\"+order).height() + 25).show().click(function(){\r\n                $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                $(\"#commonName\"+order).fadeOut(\"fast\");\r\n                $(\"#imgLink\"+order).fadeOut(\"fast\");\r\n                $(\"#sciName\"+order).fadeOut(\"fast\");\r\n                $(\"#statusText\"+order).fadeOut(\"fast\");\r\n                $(\"#speciesDescription\"+order).fadeOut(\"fast\");\r\n                $(\"#nextArrow\"+order).fadeOut(\"fast\");\r\n                $(\"#prevArrow\"+order).fadeOut(\"fast\");\r\n                $(\"#moreInfo\"+order).fadeOut(\"fast\");\r\n                setTimeout(function() {\r\n                    $(\"#imgLink\"+order).remove();\r\n                    $(\"#commonName\"+order).remove();\r\n                    $(\"#imgLink\"+order).remove();\r\n                    $(\"#sciName\"+order).remove();\r\n                    $(\"#statusText\"+order).remove();\r\n                    $(\"#speciesDescription\"+order).remove();\r\n                    $(\"#nextArrow\"+order).remove();\r\n                    $(\"#prevArrow\"+order).remove();\r\n                    $(\"#moreInfo\"+order).remove();\r\n                }, 200);\r\n                prevSpecies(attr);\r\n            });\r\n        },delay);\r\n    });\r\n\r\n    if(newPopout === true){\r\n        initSpeciesMap(attr);\r\n    }\r\n\r\n    $(\"#modalBackground\").click(function(){\r\n        $(\"#modalBackground\").fadeOut(\"fast\");\r\n        $(\"#speciesPanel\").fadeOut(\"fast\");\r\n        setTimeout(function(){\r\n            $(\"#modalBackground\").remove();\r\n            $(\"#speciesPanel\").remove();\r\n            if (iPad === false){\r\n                window.location.hash = \"overview\";\r\n            }\r\n        },200);\r\n    });\r\n};\r\n\r\nvar initSpeciesMap = function(attr){\r\n    var order;\r\n    if ($(\"#speciesMapOdd\").length > 0){\r\n        order = \"Even\";\r\n    }\r\n    else{\r\n        order = \"Odd\";\r\n\r\n    }\r\n\r\n    $(\"#speciesMap\").append(\"<div id='speciesMap\"+order+\"' class='map'></div>\");\r\n    $(\"#speciesMap\"+order).css(\"z-index\",\"0\");\r\n\r\n    var initExtent = new esri.geometry.Extent({\"xmin\":-15440190.518952178,\"ymin\":-4384014.805557845,\"xmax\":16259773.85146766,\"ymax\":10174487.34974608,\"spatialReference\":{\"wkid\":102100}});\r\n\r\n    var lods = [\r\n  \t\t{\"level\" : 0, \"resolution\" : 39135.7584820001, \"scale\" : 147914381.897889},\r\n        {\"level\" : 1, \"resolution\" : 19567.8792409999, \"scale\" : 73957190.948944},\r\n      \t{\"level\" : 2, \"resolution\" : 9783.93962049996, \"scale\" : 36978595.474472},\r\n  \t\t{\"level\" : 3, \"resolution\" : 4891.96981024998, \"scale\" : 18489297.737236},\r\n        {\"level\" : 4, \"resolution\" : 2445.98490512499, \"scale\" : 9244648.868618},\r\n        {\"level\" : 5, \"resolution\" : 1222.99245256249, \"scale\" : 4622324.434309},\r\n  \t\t//{\"level\" : 6, \"resolution\" : 611.49622628138, \"scale\" : 2311162.217155}\r\n        //{\"level\" : 7, \"resolution\" : 305.748113140558, \"scale\" : 1155581.108577},\r\n        //{\"level\" : 8, \"resolution\" : 152.874056570411, \"scale\" : 577790.554289}\r\n\t];\r\n\r\n    _speciesMap = new esri.Map(\"speciesMap\"+order,{\r\n        extent:initExtent,\r\n        wrapAround180:true,\r\n        lods:lods\r\n    });\r\n\r\n    var basemap= new esri.layers.ArcGISTiledMapServiceLayer(\"http://services.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer\");\r\n    _speciesMap.addLayer(basemap);\r\n\r\n    _outlineLayer = new esri.layers.FeatureLayer(\"http://services.arcgis.com/nzS0F0zdNLvs7nc8/arcgis/rest/services/RedList_AllRanges/FeatureServer/0\",{\r\n        mode: esri.layers.FeatureLayer.MODE_SNAPSHOT,\r\n        outFields: [\"*\"]\r\n    });\r\n    _outlineLayer.setDefinitionExpression(\"TaxonID='\"+attr.TaxonID+\"'\");\r\n    _speciesMap.addLayer(_outlineLayer);\r\n\r\n    _fillLayer = new esri.layers.FeatureLayer(\"http://services.arcgis.com/nzS0F0zdNLvs7nc8/arcgis/rest/services/RedList_AllRanges/FeatureServer/1\",{\r\n        mode: esri.layers.FeatureLayer.MODE_SNAPSHOT,\r\n        outFields: [\"*\"]\r\n    });\r\n    _fillLayer.setDefinitionExpression(\"TaxonID='\"+attr.TaxonID+\"'\");\r\n    _speciesMap.addLayer(_fillLayer);\r\n\r\n    _speciesMap.firstLoad = false;\r\n\r\n    dojo.connect(_speciesMap,\"onUpdateEnd\",function(){\r\n        if (_speciesMap.firstLoad === false){\r\n            if(_speciesMap.getLayer(_speciesMap.graphicsLayerIds[0]).graphics[0]){\r\n                _speciesMap.firstLoad = true;\r\n                _speciesMap.setExtent(_speciesMap.getLayer(_speciesMap.graphicsLayerIds[0]).graphics[0]._extent.expand(1.8));\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n    $(\"#zoomInMini\").click(function(){\r\n        _speciesMap.setLevel(_speciesMap.getLevel()+1);\r\n    });\r\n    $(\"#zoomOutMini\").click(function(){\r\n        _speciesMap.setLevel(_speciesMap.getLevel()-1);\r\n    });\r\n    $(\"#zoomExtentMini\").click(function(){\r\n        _speciesMap.setExtent(_speciesMap.getLayer(_speciesMap.graphicsLayerIds[0]).graphics[0]._extent.expand(1.8));\r\n    });\r\n\r\n};\r\n\r\nvar nextSpecies = function(attr){\r\n    for(i=0;i<_currentSpecies.length;i++){\r\n        if(_currentSpecies[i].TaxonID === attr.TaxonID){\r\n            if (i === _currentSpecies.length - 1){\r\n                _speciesMap.firstLoad = false;\r\n                _outlineLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[0].TaxonID+\"'\");\r\n                _fillLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[0].TaxonID+\"'\");\r\n                openPopout(_currentSpecies[0],false);\r\n            }\r\n            else{\r\n                _speciesMap.firstLoad = false;\r\n                _outlineLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[i+1].TaxonID+\"'\");\r\n                _fillLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[i+1].TaxonID+\"'\");\r\n                openPopout(_currentSpecies[i+1],false);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nvar prevSpecies = function(attr){\r\n    for(i=0;i<_currentSpecies.length;i++){\r\n        if(_currentSpecies[i].TaxonID === attr.TaxonID){\r\n            if (i === 0){\r\n                _speciesMap.firstLoad = false;\r\n                _outlineLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[_currentSpecies.length - 1].TaxonID+\"'\");\r\n                _fillLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[_currentSpecies.length - 1].TaxonID+\"'\");\r\n                openPopout(_currentSpecies[_currentSpecies.length - 1],false);\r\n            }\r\n            else{\r\n                _speciesMap.firstLoad = false;\r\n                _outlineLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[i-1].TaxonID+\"'\");\r\n                _fillLayer.setDefinitionExpression(\"TaxonID='\"+_currentSpecies[i-1].TaxonID+\"'\");\r\n                openPopout(_currentSpecies[i-1],false);\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nvar getWidth = function(){\r\n    if (iPad === true){\r\n        return 280;\r\n    }\r\n    else{\r\n        return 400;\r\n    }\r\n}"]],"start1":8778,"start2":8778,"length1":16,"length2":12583}]],"length":21361,"saved":false}
{"ts":1345749305730,"patch":[[{"diffs":[[0,"Text'>IU"],[1,"CN "],[0,"RED LIST"]],"start1":11952,"start2":11952,"length1":16,"length2":19}]],"length":21364,"saved":false}
